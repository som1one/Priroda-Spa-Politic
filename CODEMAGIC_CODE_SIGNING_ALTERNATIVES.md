# üîê –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–¥–ø–∏—Å–∏ iOS –≤ Codemagic

## üö® –ü—Ä–æ–±–ª–µ–º–∞

–û—à–∏–±–∫–∞: `No valid code signing certificates were found`

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–ø–∏—Å—å —á–µ—Ä–µ–∑ App Store Connect API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

---

## ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 1: Manual Code Signing (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–°–æ–∑–¥–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤—Ä—É—á–Ω—É—é –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ Codemagic.

### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ Apple Developer Portal

1. **–í–æ–π–¥–∏—Ç–µ –≤ [developer.apple.com/account](https://developer.apple.com/account)**
2. **Certificates, Identifiers & Profiles** ‚Üí **Certificates**
3. –ù–∞–∂–º–∏—Ç–µ **"+"** ‚Üí **iOS Distribution** ‚Üí **App Store and Ad Hoc**
4. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
5. **–°–∫–∞—á–∞–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** (`.cer` —Ñ–∞–π–ª)

### –®–∞–≥ 2: –°–æ–∑–¥–∞–π—Ç–µ Provisioning Profile

1. **Certificates, Identifiers & Profiles** ‚Üí **Profiles**
2. –ù–∞–∂–º–∏—Ç–µ **"+"** ‚Üí **App Store** ‚Üí **Continue**
3. –í—ã–±–µ—Ä–∏—Ç–µ App ID: `com.prirodaspa.app`
4. –í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (—Å–æ–∑–¥–∞–Ω–Ω—ã–π –≤—ã—à–µ)
5. **Generate** ‚Üí **Download** (`.mobileprovision` —Ñ–∞–π–ª)

### –®–∞–≥ 3: –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤ .p12

**–ù–∞ Mac:**
```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ .cer —Ñ–∞–π–ª –≤ Keychain Access
# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∫–∞–∫ .p12 —Å –ø–∞—Ä–æ–ª–µ–º
```

**–ë–µ–∑ Mac:**
- –ü–æ–ø—Ä–æ—Å–∏—Ç–µ –∫–æ–≥–æ-—Ç–æ —Å Mac —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–Ω–ª–∞–π–Ω-—Å–µ—Ä–≤–∏—Å—ã (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –®–∞–≥ 4: –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤ Codemagic

1. **Codemagic ‚Üí Settings ‚Üí Code signing ‚Üí iOS code signing**
2. –í—ã–±–µ—Ä–∏—Ç–µ **"Manual"** (–Ω–µ Automatic)
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ:
   - **Certificate:** `.p12` —Ñ–∞–π–ª
   - **Certificate password:** –ø–∞—Ä–æ–ª—å –æ—Ç .p12
   - **Provisioning profile:** `.mobileprovision` —Ñ–∞–π–ª
4. **Save**

### –®–∞–≥ 5: –û–±–Ω–æ–≤–∏—Ç–µ codemagic.yaml

```yaml
code_signing:
  ios:
    certificate_type: app_store
    bundle_identifier: com.prirodaspa.app
    # Manual signing - —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ UI
```

---

## ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UI Workflow (–ë–µ–∑ yaml)

–°–æ–∑–¥–∞—Ç—å workflow –ø–æ–ª–Ω–æ—Å—Ç—å—é —á–µ—Ä–µ–∑ UI Codemagic.

### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Workflow —á–µ—Ä–µ–∑ UI

1. **Codemagic ‚Üí Workflows ‚Üí "+" ‚Üí Create workflow**
2. –í—ã–±–µ—Ä–∏—Ç–µ **"iOS"**

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Code Signing –≤ UI

1. **Code signing ‚Üí iOS code signing**
2. **–ú–µ—Ç–æ–¥:** Automatic
3. **App Store Connect API key:** "Priroda Spa"
4. **Bundle identifier:** `com.prirodaspa.app`
5. **Provisioning profile type:** App store
6. **Save**

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Build

1. **Working directory:** `spa`
2. **Flutter version:** stable
3. **Build command:** `flutter build ipa --release`
4. **Save**

### –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–±–æ—Ä–∫—É

- UI workflow –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ª—É—á—à–µ, —á–µ–º yaml –¥–ª—è code signing

---

## ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Fastlane Match

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏ —á–µ—Ä–µ–∑ Fastlane.

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Fastlane

```bash
gem install fastlane
```

### –®–∞–≥ 2: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ Match

```bash
cd spa/ios
fastlane match init
fastlane match appstore
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤ Codemagic

–î–æ–±–∞–≤—å—Ç–µ –≤ `codemagic.yaml`:

```yaml
scripts:
  - name: Setup Fastlane Match
    script: |
      cd ios
      fastlane match appstore --readonly
```

---

## ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GitHub Actions

–ï—Å–ª–∏ Codemagic –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GitHub Actions —Å Mac runner.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- ‚úÖ –£–∂–µ –µ—Å—Ç—å workflow –≤ –ø—Ä–æ–µ–∫—Ç–µ (`.github/workflows/ios-build.yml`)

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
- ‚ùå –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤—Ä—É—á–Ω—É—é
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫—É

---

## ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ App Store Connect API

–í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–±–ª–µ–º–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö API –∫–ª—é—á–∞.

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **App Store Connect API –∫–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π:**
   - Issuer ID: `4fbfcedf-2756-4b8e-8fc3-b17978e9532a`
   - Key ID: `84SR375827`
   - .p8 —Ñ–∞–π–ª: –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ

2. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ Codemagic –Ω–∞–∑–≤–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
   - `APP_STORE_ISSUER_ID`
   - `APP_STORE_KEY_ID`
   - `APP_STORE_PRIVATE_KEY`

3. **Bundle ID –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:**
   - [developer.apple.com/account](https://developer.apple.com/account) ‚Üí Identifiers
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å: `com.prirodaspa.app`

4. **API –∫–ª—é—á –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞:**
   - App Store Connect ‚Üí Users and Access ‚Üí Keys
   - –ö–ª—é—á –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø: **App Manager** –∏–ª–∏ **Admin**

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π

### –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤ —Ç–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ:

1. **–í–∞—Ä–∏–∞–Ω—Ç 2: UI Workflow** (—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π)
   - –°–æ–∑–¥–∞–π—Ç–µ workflow —á–µ—Ä–µ–∑ UI
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ code signing –≤ UI
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏

2. **–í–∞—Ä–∏–∞–Ω—Ç 1: Manual Code Signing** (–µ—Å–ª–∏ UI –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
   - –°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤—Ä—É—á–Ω—É—é
   - –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤ Codemagic
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Manual signing

3. **–í–∞—Ä–∏–∞–Ω—Ç 4: GitHub Actions** (–µ—Å–ª–∏ Codemagic —Å–æ–≤—Å–µ–º –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π workflow
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

**–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –ø—Ä–æ–±–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:**

1. ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ: `APP_STORE_ISSUER_ID`, `APP_STORE_KEY_ID`, `APP_STORE_PRIVATE_KEY`
2. ‚úÖ Bundle ID –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ Apple Developer Portal
3. ‚úÖ API –∫–ª—é—á –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
4. ‚úÖ –í UI Codemagic –Ω–∞—Å—Ç—Ä–æ–µ–Ω Automatic code signing

---

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—á–Ω–∏—Ç–µ —Å **–í–∞—Ä–∏–∞–Ω—Ç–∞ 2 (UI Workflow)** - —ç—Ç–æ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±. –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–í–∞—Ä–∏–∞–Ω—Ç 1 (Manual Code Signing)**.

